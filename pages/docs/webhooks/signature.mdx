---
title: "Webhook Signature Verification"
---

Webhooks are a powerful way to receive real-time notifications about payment events. However, it's crucial to ensure that the webhook requests you receive are genuinely from MovePay and not from a malicious source. To achieve this, you can verify the signature of the webhook payload.
This guide will walk you through the process of verifying the webhook signature using a secret key.

## Step 1: Obtain Your Secret Key
To verify the webhook signature, you need to obtain your secret key from the MovePay Merchant Panel. This key is used to generate the HMAC signature for the webhook payload.
1. Log in to the [MovePay Merchant Panel](https://merchant.movepayment.eu).
2. Navigate to the **Other-API Settings** section.
3. Click on the **Webhooks** tab.
4. Find the webhook you want to verify.
5. Copy the **Secret Key** provided in the webhook information section.

## Step 2: Verify the Signature
When you receive a webhook request, you can verify the signature using the following steps:
1. Extract the `X-Signature` header from the incoming request. This header contains the HMAC signature generated by MovePay.
2. Extract the payload from the request body.
3. Generate the HMAC signature using the payload and your secret key.
4. Compare the generated signature with the signature from the `X-Signature` header. If they match, the request is valid and comes from MovePay.

## Example Code
Here's an example of how to verify the webhook signature in Node.js using the `crypto` module:
```javascript
const crypto = require('crypto');
const express = require('express');
const app = express();  
const bodyParser = require('body-parser');
app.use(bodyParser.json());

const SECRET_KEY = 'your-secret-key'; // Replace with your actual secret key

app.post('/webhook', (req, res) => {
  const signature = req.headers['x-signature'];
  const payload = JSON.stringify(req.body);

  const hmac = crypto.createHmac('sha256', SECRET_KEY);
  const generatedSignature = hmac.update(payload).digest('hex');

  if (generatedSignature === signature) {
    console.log('Signature is valid. Webhook is verified.');
    res.status(200).send('ok');
  } else {
    console.error('Invalid signature. Webhook verification failed.');
    res.status(400).send('error');
  }
});

app.listen(3000, () => {
  console.log('Server is running on port 3000');
});
```
